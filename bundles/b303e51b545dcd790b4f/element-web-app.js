(self.webpackChunkelement_web=self.webpackChunkelement_web||[]).push([[673],{"./node_modules/matrix-react-sdk/src/components/views/auth/AuthHeaderLogo.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var r=s("./node_modules/react/index.js"),n=s("./node_modules/matrix-react-sdk/src/SdkConfig.ts");class o extends r.PureComponent{render(){var e;const t=n.ZP.getObject("branding"),s=null!==(e=null==t?void 0:t.get("auth_header_logo_url"))&&void 0!==e?e:"themes/element/img/logos/element-logo.svg";return r.createElement("aside",{className:"mx_AuthHeaderLogo"},r.createElement("img",{src:s,alt:"Element"}))}}},"./node_modules/matrix-react-sdk/src/components/views/auth/AuthPage.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var r=s("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("./node_modules/react/index.js"),o=s("./node_modules/matrix-react-sdk/src/SdkConfig.ts"),a=s("./src/languageHandler.tsx");const i=()=>{var e;const t=o.ZP.getObject("branding"),s=null!==(e=null==t?void 0:t.get("auth_footer_links"))&&void 0!==e?e:[{text:"Blog",url:"https://element.io/blog"},{text:"Twitter",url:"https://twitter.com/element_hq"},{text:"GitHub",url:"https://github.com/vector-im/element-web"}],r=[];for(const e of s)r.push(n.createElement("a",{href:e.url,key:e.text,target:"_blank",rel:"noreferrer noopener"},e.text));return n.createElement("footer",{className:"mx_AuthFooter",role:"contentinfo"},r,n.createElement("a",{href:"https://matrix.org",target:"_blank",rel:"noreferrer noopener"},(0,a._t)("powered_by_matrix")))};class d extends n.PureComponent{static getWelcomeBackgroundUrl(){if(d.welcomeBackgroundUrl)return d.welcomeBackgroundUrl;const e=o.ZP.getObject("branding");d.welcomeBackgroundUrl="themes/element/img/backgrounds/lake.jpg";const t=null==e?void 0:e.get("welcome_background_url");if(t)if(Array.isArray(t)){const e=Math.floor(Math.random()*t.length);d.welcomeBackgroundUrl=t[e]}else d.welcomeBackgroundUrl=t;return d.welcomeBackgroundUrl}render(){const e={background:`center/cover fixed url(${d.getWelcomeBackgroundUrl()})`},t={position:"absolute",top:0,right:0,bottom:0,left:0,filter:"blur(40px)",background:e.background};return n.createElement("div",{className:"mx_AuthPage",style:e},n.createElement("div",{className:"mx_AuthPage_modal",style:{position:"relative",background:"initial"}},n.createElement("div",{className:"mx_AuthPage_modalBlur",style:t}),n.createElement("div",{className:"mx_AuthPage_modalContent",style:{display:"flex",zIndex:1,background:"rgba(255, 255, 255, 0.59)",borderRadius:"8px"}},this.props.children)),n.createElement(i,null))}}(0,r.Z)(d,"welcomeBackgroundUrl",void 0)},"./src/vector/app.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{loadApp:()=>C});s("./node_modules/matrix-js-sdk/src/browser-index.ts");var r=s("./node_modules/react/index.js"),n=s("./node_modules/matrix-react-sdk/src/PlatformPeg.ts"),o=s("./node_modules/matrix-react-sdk/src/utils/AutoDiscoveryUtils.tsx"),a=s("./node_modules/matrix-js-sdk/src/autodiscovery.ts"),i=s("./node_modules/matrix-react-sdk/src/Lifecycle.ts"),d=s("./node_modules/matrix-react-sdk/src/SdkConfig.ts"),c=s("./node_modules/matrix-js-sdk/src/logger.ts"),l=s("./node_modules/matrix-js-sdk/src/matrix.ts"),m=s("./node_modules/matrix-react-sdk/src/utils/SnakedObject.ts"),f=s("./node_modules/matrix-react-sdk/src/components/structures/MatrixChat.tsx"),u=s("./node_modules/@matrix-org/react-sdk-module-api/lib/lifecycles/WrapperLifecycle.js"),g=s("./node_modules/matrix-react-sdk/src/modules/ModuleRunner.ts"),x=s("./src/vector/url_utils.ts");let _=null;function k(e){const t=(0,x.D)(e);return{screen:t.location.substring(1),params:t.params}}function w(){decodeURIComponent(window.location.hash)!==_&&function(e){if(!window.matrixChat)return;c.k.log("Routing URL ",e.href);const t=k(e);window.matrixChat.showScreen(t.screen,t.params)}(window.location)}function h(e,t=!1){c.k.log("newscreen "+e);const s="#/"+e;_=s,e.startsWith("room/")&&window.location.hash.includes("/$")===s.includes("/$")&&window.location.hash.startsWith(s)&&(t=!0),t?window.location.replace(s):window.location.assign(s)}const v="mx_screen_after_login";function p(e){const t=k(e);(t.screen||t.params)&&function(e){null!=e&&e.screen&&sessionStorage.setItem(v,JSON.stringify(e))}(t);const s=function(){const e=sessionStorage.getItem(v);return e?JSON.parse(e):void 0}();return s}var b=s("./src/languageHandler.tsx");function y(){const e=new URL(window.location.href);e.searchParams.delete("loginToken"),e.searchParams.delete("state"),e.searchParams.delete("code"),c.k.log(`Redirecting to ${e.href} to drop delegated authentication params from queryparams`),window.history.replaceState(null,"",e.href)}async function C(e,t){var s;window.addEventListener("hashchange",w);const _=n.Z.get(),v=(0,x.l)(window.location),C=window.location.protocol+"//"+window.location.host+window.location.pathname;c.k.log("Vector starting at "+C),_.startUpdater();const U=await async function(){let e;try{c.k.log("Verifying homeserver configuration");const t=d.ZP.get();let s=t.default_server_config;const r=t.default_server_name,n=t.default_hs_url,i=t.default_is_url,l=[s,r,n].filter((e=>!!e));if(n&&(s||r))throw new b.yh("error|invalid_configuration_mixed_server");if(l.length<1)throw new b.yh("error|invalid_configuration_no_server");let m;n&&(c.k.log("Config uses a default_hs_url - constructing a default_server_config using this information"),c.k.warn("DEPRECATED CONFIG OPTION: In the future, default_hs_url will not be accepted. Please use default_server_config instead."),s={"m.homeserver":{base_url:n}},i&&(s["m.identity_server"]={base_url:i})),!r&&s&&(c.k.log("Config uses a default_server_config - validating object"),m=await a.mb.fromDiscoveryConfig(s)),r&&(c.k.log("Config uses a default_server_name - doing .well-known lookup"),c.k.warn("DEPRECATED CONFIG OPTION: In the future, default_server_name will not be accepted. Please use default_server_config instead."),m=await a.mb.findClientConfig(r),null===m["m.homeserver"].base_url&&s&&(c.k.log("Finding base_url failed but a default_server_config was found - using it as a fallback"),m=await a.mb.fromDiscoveryConfig(s))),e=o.Z.buildValidatedConfigFromDiscovery(r,m,!0)}catch(t){const{hsUrl:s,isUrl:r,userId:n}=await i.dI();if(!s||!n)throw t;c.k.error(t),c.k.warn("A session was found - suppressing config error and using the session's homeserver"),c.k.log("Using pre-existing hsUrl and isUrl: ",{hsUrl:s,isUrl:r}),e=await o.Z.validateServerConfigWithStaticUrls(s,r,!0)}return e.isDefault=!0,c.k.log("Using homeserver config:",e),c.k.log("Updating SdkConfig with validated discovery information"),d.ZP.add({validated_server_config:e}),d.ZP.get()}(),E=new m.B(U),[P]=await i.nr(),S=!!P,O=!!v.loginToken,j=(0,d.vj)(U);let A=!0===j.immediate;const D="#/welcome"===window.location.hash||"#"===window.location.hash||""===window.location.hash;if(!A&&j.on_welcome_page&&D&&(A=!0),!S&&!O&&A){c.k.log("Bypassing app load to redirect to SSO");const e=(0,l.createClient)({baseUrl:U.validated_server_config.hsUrl,idBaseUrl:U.validated_server_config.isUrl});return n.Z.get().startSingleSignOn(e,"sso",`/${k(window.location).screen}`),r.createElement(r.Fragment,null)}const N=null!==(s=E.get("default_device_display_name"))&&void 0!==s?s:null==_?void 0:_.getDefaultDeviceDisplayName(),I=p(window.location),B={Wrapper:r.Fragment};return g.E.instance.invoke(u.U.Wrapper,B),r.createElement(B.Wrapper,null,r.createElement(f.Z,{ref:t,onNewScreen:h,config:U,realQueryParams:v,startingFragmentQueryParams:e,enableGuest:!U.disable_guests,onTokenLoginCompleted:y,initialScreenAfterLogin:I,defaultDeviceDisplayName:N}))}window.React=r,c.k.log("Application is running in production mode"),window.matrixLogger=c.k},"./node_modules/matrix-react-sdk/src/effects lazy recursive ^\\.\\/.*$ referencedExports: default":(e,t,s)=>{var r={"./":["./node_modules/matrix-react-sdk/src/effects/index.ts",9],"./ICanvasEffect":["./node_modules/matrix-react-sdk/src/effects/ICanvasEffect.ts",7,61],"./ICanvasEffect.ts":["./node_modules/matrix-react-sdk/src/effects/ICanvasEffect.ts",7,61],"./confetti":["./node_modules/matrix-react-sdk/src/effects/confetti/index.ts",9,261],"./confetti/":["./node_modules/matrix-react-sdk/src/effects/confetti/index.ts",9,261],"./confetti/index":["./node_modules/matrix-react-sdk/src/effects/confetti/index.ts",9,261],"./confetti/index.ts":["./node_modules/matrix-react-sdk/src/effects/confetti/index.ts",9,261],"./effect":["./node_modules/matrix-react-sdk/src/effects/effect.ts",9,502],"./effect.ts":["./node_modules/matrix-react-sdk/src/effects/effect.ts",9,502],"./fireworks":["./node_modules/matrix-react-sdk/src/effects/fireworks/index.ts",9,379],"./fireworks/":["./node_modules/matrix-react-sdk/src/effects/fireworks/index.ts",9,379],"./fireworks/index":["./node_modules/matrix-react-sdk/src/effects/fireworks/index.ts",9,379],"./fireworks/index.ts":["./node_modules/matrix-react-sdk/src/effects/fireworks/index.ts",9,379],"./hearts":["./node_modules/matrix-react-sdk/src/effects/hearts/index.ts",9,749],"./hearts/":["./node_modules/matrix-react-sdk/src/effects/hearts/index.ts",9,749],"./hearts/index":["./node_modules/matrix-react-sdk/src/effects/hearts/index.ts",9,749],"./hearts/index.ts":["./node_modules/matrix-react-sdk/src/effects/hearts/index.ts",9,749],"./index":["./node_modules/matrix-react-sdk/src/effects/index.ts",9],"./index.ts":["./node_modules/matrix-react-sdk/src/effects/index.ts",9],"./rainfall":["./node_modules/matrix-react-sdk/src/effects/rainfall/index.ts",9,507],"./rainfall/":["./node_modules/matrix-react-sdk/src/effects/rainfall/index.ts",9,507],"./rainfall/index":["./node_modules/matrix-react-sdk/src/effects/rainfall/index.ts",9,507],"./rainfall/index.ts":["./node_modules/matrix-react-sdk/src/effects/rainfall/index.ts",9,507],"./snowfall":["./node_modules/matrix-react-sdk/src/effects/snowfall/index.ts",9,997],"./snowfall/":["./node_modules/matrix-react-sdk/src/effects/snowfall/index.ts",9,997],"./snowfall/index":["./node_modules/matrix-react-sdk/src/effects/snowfall/index.ts",9,997],"./snowfall/index.ts":["./node_modules/matrix-react-sdk/src/effects/snowfall/index.ts",9,997],"./spaceinvaders":["./node_modules/matrix-react-sdk/src/effects/spaceinvaders/index.ts",9,477],"./spaceinvaders/":["./node_modules/matrix-react-sdk/src/effects/spaceinvaders/index.ts",9,477],"./spaceinvaders/index":["./node_modules/matrix-react-sdk/src/effects/spaceinvaders/index.ts",9,477],"./spaceinvaders/index.ts":["./node_modules/matrix-react-sdk/src/effects/spaceinvaders/index.ts",9,477],"./utils":["./node_modules/matrix-react-sdk/src/effects/utils.ts",9],"./utils.ts":["./node_modules/matrix-react-sdk/src/effects/utils.ts",9]};function n(e){if(!s.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],n=t[0];return Promise.all(t.slice(2).map(s.e)).then((()=>s.t(n,16|t[1])))}n.keys=()=>Object.keys(r),n.id="./node_modules/matrix-react-sdk/src/effects lazy recursive ^\\.\\/.*$ referencedExports: default",e.exports=n}}]);
//# sourceMappingURL=element-web-app.js.map